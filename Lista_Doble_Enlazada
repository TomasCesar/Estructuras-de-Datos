#include <stdio.h>
#include <stdlib.h>

struct Lista{
  int dato;
  struct Lista *anterior;
  struct Lista* siguiente;
};
struct Lista *insertar(int, struct Lista*);
struct Lista *mostrar(struct Lista*);
struct Lista *borrar(int,struct Lista*);

int main(){
  int num;
  struct Lista *Lista = NULL;
  Lista= insertar(8,Lista);
  Lista= insertar(7,Lista);
  Lista= insertar(12,Lista);
  Lista= insertar(5,Lista);
  mostrar(Lista);
  printf("\n");
  Lista= borrar(5,Lista);
  Lista= borrar(7,Lista);
  mostrar(Lista);
    scanf("%d",&num);
    return 0;
}

struct Lista *insertar (int dato,struct Lista* Lista){
  struct  Lista *nuevo = NULL;
  struct  Lista *aux=NULL;
  nuevo = (struct Lista*)malloc(sizeof(struct Lista));
  nuevo->dato=dato;
  if(Lista==NULL){
    Lista=nuevo;
  }
  else{
    aux=Lista;
    while(aux->siguiente!=NULL){
      aux=aux->siguiente;
    }
    aux->siguiente=nuevo;
    nuevo->anterior=aux;
  }
  return Lista;
}

struct Lista *borrar(int dato, struct Lista* Lista){
  struct Lista *aux=NULL;
  aux=Lista;
  if(aux==NULL){
    printf("\nNO hay datos a eliminar");;
  }
  else{
    while(aux->dato!=dato ){
      if(aux->siguiente==NULL){
        printf("\nEL dato no existe\n");
        break;
      }
      aux=aux->siguiente;
    }
    if(aux->siguiente==NULL && aux->anterior==NULL){
      free(aux);
    }
    else if(aux->siguiente==NULL){
      aux->anterior->siguiente=NULL;
      free(aux);
    }
    else if(aux->anterior==NULL){
      aux->siguiente->anterior=NULL;
      free(aux);
    }
    else{
        aux->siguiente->anterior=aux->anterior;
        aux->anterior->siguiente=aux->siguiente;
        free(aux);
    }
  }
  return Lista;
}

struct Lista *mostrar(struct Lista* Lista){
  while(Lista!=NULL){
    printf("%d\n",Lista->dato);
    Lista=Lista->siguiente;
  }
  return Lista;
}
